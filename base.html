<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stock and Inventory Management</title>
<script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<style>
  body {
    font-family: "Inter", serif;
    font-optical-sizing: auto;
    font-weight: 400;
    font-style: normal;
  }

  [x-cloak] {
    display: none !important;
  }

  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
    width: 250px;
    background-color: #fff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease-in-out;
    transform: translateX(-100%);
  }

  .sidebar.open {
    transform: translateX(0);
  }

  .sidebar .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    border-bottom: 1px solid #e2e8f0;
  }

  .sidebar .content {
    padding: 1rem;
  }

  .sidebar .nav-link {
    display: block;
    padding: 0.5rem 1rem;
    color: #333;
    text-decoration: none;
    border-radius: 4px;
  }

  .sidebar .nav-link:hover {
    background-color: #f1f5f9;
  }

  .main-content {
    margin-left: 0;
    transition: margin-left 0.3s ease-in-out;
  }

  .main-content.sidebar-open {
    margin-left: 250px;
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    background-color: #fff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }

  .header .menu-icon {
    cursor: pointer;
  }

  .header .menu-icon .material-icons {
    font-size: 24px;
  }

  .header .actions {
    display: flex;
    align-items: center;
  }

  .header .actions .material-icons {
    font-size: 24px;
    margin-left: 1rem;
    cursor: pointer;
  }

  .notifications {
    position: absolute;
    top: 50px;
    right: 1rem;
    width: 250px;
    background-color: #fff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border-radius: 4px;
    display: none;
  }

  .notifications.open {
    display: block;
  }

  .notifications .header {
    padding: 1rem;
    border-bottom: 1px solid #e2e8f0;
    font-weight: bold;
  }

  .notifications .content {
    padding: 1rem;
  }

  .notifications .content li {
    margin-bottom: 0.5rem;
  }
</style>
</head>
<body class="bg-gray-100">
  <div id="app">
    <div class="flex h-screen">
      <!-- Sidebar -->
      <div class="sidebar" :class="{ 'open': sidebarOpen }">
        <div class="header">
          <h1 class="text-lg font-semibold">Inventory Manager</h1>
          <button @click="toggleSidebar" class="text-gray-600 hover:text-gray-800">
            <span class="material-icons">menu</span>
          </button>
        </div>
        <div class="content">
          <div class="flex items-center space-x-3 mb-6">
            <div class="w-10 h-10 bg-gray-200 rounded-full"></div>
            <div>
              <p class="font-medium" v-text="user_details.title"></p>
              <p class="text-sm text-gray-500">
                Admin |
                <span @click="logout()" class="text-red-500 hover:text-red-800 cursor-pointer"> Logout </span>
              </p>
            </div>
          </div>
          <nav>
            <a href="/index.html" class="nav-link">Dashboard</a>
            <a href="/masters.html" class="nav-link">Masters</a>
            <a href="#" class="nav-link">Inventory</a>
            <a href="#" class="nav-link">Indents</a>
            <a href="#" class="nav-link">Reports</a>
          </nav>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content flex-1" :class="{ 'sidebar-open': sidebarOpen }">
        <header class="header">
          <button @click="toggleSidebar" class="menu-icon text-gray-600">
            <span class="material-icons">menu</span>
          </button>
          <div class="actions">
            <button @click="toggleNotifications" class="relative text-gray-600 hover:text-gray-800">
              <span class="material-icons">notifications</span>
              <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
            </button>
            <button @click="logout()" class="text-red-600 hover:text-red-800">
              <span class="material-icons">logout</span>
            </button>
          </div>
        </header>
        <main class="p-8">
          <div class="border-dashed border-4 border-gray-300 h-64 flex items-center justify-center">
            <p class="text-gray-500">Content goes here</p>
          </div>
        </main>
      </div>

      <!-- Notifications -->
      <div class="notifications" :class="{ 'open': notificationsOpen }">
        <div class="header">Notifications</div>
        <div class="content">
          <ul>
            <li class="text-sm">New order placed</li>
            <li class="text-sm">Stock updated</li>
            <li class="text-sm">Low inventory alert</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

<script>
  let authToken = window.localStorage.getItem("authToken") ? window.localStorage.getItem("authToken") : '';

  Vue.createApp({
    data() {
      return {
        sidebarOpen: localStorage.getItem('sidebarOpen') === 'true',
        notificationsOpen: false,
        user_details: {
          "title": "loading"
        }
      };
    },
    mounted() {
      console.log("this is mounted now.");
      this.check_auth_state();
    },
    methods: {
      check_auth_state() {
        authToken = window.localStorage.getItem("authToken") ? window.localStorage.getItem("authToken") : '';
        if (authToken) {
          console.log("logged in");
          this.fetch_user_details();
        } else {
          location.href = "/login.html";
        }
      },
      logout() {
        window.localStorage.setItem("authToken", "");
        location.href = "/login.html";
      },
      toggleSidebar() {
        this.sidebarOpen = !this.sidebarOpen;
        localStorage.setItem('sidebarOpen', this.sidebarOpen);
      },
      toggleNotifications() {
        this.notificationsOpen = !this.notificationsOpen;
      },
      async fetch_user_details() {
        try {
          const response = await fetch('https://prod-api.manupal.dev/users/me', {
            method: 'GET',
            headers: {
              'Content-Type': 'application/json',
              Authorization: `Bearer ${authToken}`,
            },
          });

          if (response.ok) {
            const data = await response.json();
            console.log("logged in users details", data);
            this.user_details = data["user_details"];
          } else {
            alert('Invalid credentials');
          }
        } catch (error) {
          alert('Error during login: ' + error.message);
        }
      }
    }
  }).mount('#app');
</script>
</body>
</html>